<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Docstrings · RetentionParameterEstimator</title><meta name="title" content="Docstrings · RetentionParameterEstimator"/><meta property="og:title" content="Docstrings · RetentionParameterEstimator"/><meta property="twitter:title" content="Docstrings · RetentionParameterEstimator"/><meta name="description" content="Documentation for RetentionParameterEstimator."/><meta property="og:description" content="Documentation for RetentionParameterEstimator."/><meta property="twitter:description" content="Documentation for RetentionParameterEstimator."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="RetentionParameterEstimator logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">RetentionParameterEstimator</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Docstrings</a><ul class="internal"><li><a class="tocitem" href="#Module-Index"><span>Module Index</span></a></li><li><a class="tocitem" href="#Detailed-API"><span>Detailed API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Docstrings</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Docstrings</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/main/docs/src/docstrings.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Module-Index"><a class="docs-heading-anchor" href="#Module-Index">Module Index</a><a id="Module-Index-1"></a><a class="docs-heading-anchor-permalink" href="#Module-Index" title="Permalink"></a></h2><ul><li><a href="#RetentionParameterEstimator.Program-Tuple{Any, Any, Any}"><code>RetentionParameterEstimator.Program</code></a></li><li><a href="#RetentionParameterEstimator.check_measurement-Tuple{Any, Any}"><code>RetentionParameterEstimator.check_measurement</code></a></li><li><a href="#RetentionParameterEstimator.elution_temperature-Tuple{Any, Any}"><code>RetentionParameterEstimator.elution_temperature</code></a></li><li><a href="#RetentionParameterEstimator.estimate_parameters-Tuple{Any}"><code>RetentionParameterEstimator.estimate_parameters</code></a></li><li><a href="#RetentionParameterEstimator.estimate_start_parameter-Tuple{DataFrame, Any, Any}"><code>RetentionParameterEstimator.estimate_start_parameter</code></a></li><li><a href="#RetentionParameterEstimator.estimate_start_parameter_mean_elu_temp-Tuple{DataFrame, Any, Any}"><code>RetentionParameterEstimator.estimate_start_parameter_mean_elu_temp</code></a></li><li><a href="#RetentionParameterEstimator.estimate_start_parameter_single_ramp-Tuple{DataFrame, Any, Any}"><code>RetentionParameterEstimator.estimate_start_parameter_single_ramp</code></a></li><li><a href="#RetentionParameterEstimator.load_chromatograms-Tuple{Dict{Any, Any}}"><code>RetentionParameterEstimator.load_chromatograms</code></a></li><li><a href="#RetentionParameterEstimator.load_chromatograms-Tuple{Any}"><code>RetentionParameterEstimator.load_chromatograms</code></a></li><li><a href="#RetentionParameterEstimator.loss-NTuple{8, Any}"><code>RetentionParameterEstimator.loss</code></a></li><li><a href="#RetentionParameterEstimator.loss-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Vector{String}, Any, Any, Vector{&lt;:GasChromatographySimulator.Program}, Any}} where T&lt;:Number"><code>RetentionParameterEstimator.loss</code></a></li><li><a href="#RetentionParameterEstimator.match_stderrors_by_name-Tuple{Any, Any}"><code>RetentionParameterEstimator.match_stderrors_by_name</code></a></li><li><a href="#RetentionParameterEstimator.match_stderrors_m3_by_name-Tuple{Any, Any}"><code>RetentionParameterEstimator.match_stderrors_m3_by_name</code></a></li><li><a href="#RetentionParameterEstimator.method_m1-Tuple{Any, Any}"><code>RetentionParameterEstimator.method_m1</code></a></li><li><a href="#RetentionParameterEstimator.method_m2-Tuple{Any}"><code>RetentionParameterEstimator.method_m2</code></a></li><li><a href="#RetentionParameterEstimator.method_m3-Tuple{Any}"><code>RetentionParameterEstimator.method_m3</code></a></li><li><a href="#RetentionParameterEstimator.method_m4-Tuple{Any}"><code>RetentionParameterEstimator.method_m4</code></a></li><li><a href="#RetentionParameterEstimator.opt_Kcentric-Tuple{Any, Any}"><code>RetentionParameterEstimator.opt_Kcentric</code></a></li><li><a href="#RetentionParameterEstimator.opt_dKcentric-Tuple{Any, Any}"><code>RetentionParameterEstimator.opt_dKcentric</code></a></li><li><a href="#RetentionParameterEstimator.opt_d_only-Tuple{Any, Any}"><code>RetentionParameterEstimator.opt_d_only</code></a></li><li><a href="#RetentionParameterEstimator.optimize_Kcentric-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Vector{T}, Vector{T}, Vector{T}}} where T&lt;:Number"><code>RetentionParameterEstimator.optimize_Kcentric</code></a></li><li><a href="#RetentionParameterEstimator.optimize_dKcentric-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Number, Vector{T}, Vector{T}, Vector{T}}} where T&lt;:Number"><code>RetentionParameterEstimator.optimize_dKcentric</code></a></li><li><a href="#RetentionParameterEstimator.optimize_d_only-Union{Tuple{T}, Tuple{Vector{T}, Vararg{Any, 8}}} where T&lt;:Number"><code>RetentionParameterEstimator.optimize_d_only</code></a></li><li><a href="#RetentionParameterEstimator.prepare_optimization_data-NTuple{4, Any}"><code>RetentionParameterEstimator.prepare_optimization_data</code></a></li><li><a href="#RetentionParameterEstimator.prepare_single_substance_data-Tuple{Any, Any, Any}"><code>RetentionParameterEstimator.prepare_single_substance_data</code></a></li><li><a href="#RetentionParameterEstimator.prog_list-Tuple{Any, Any}"><code>RetentionParameterEstimator.prog_list</code></a></li><li><a href="#RetentionParameterEstimator.reference_holdup_time-Tuple{Any, Any}"><code>RetentionParameterEstimator.reference_holdup_time</code></a></li><li><a href="#RetentionParameterEstimator.separate_error_columns-Tuple{Any}"><code>RetentionParameterEstimator.separate_error_columns</code></a></li><li><a href="#RetentionParameterEstimator.stderror_m3-Tuple{Any, Any}"><code>RetentionParameterEstimator.stderror_m3</code></a></li><li><a href="#RetentionParameterEstimator.substance_list-Tuple{Any, Any}"><code>RetentionParameterEstimator.substance_list</code></a></li><li><a href="#RetentionParameterEstimator.tR_calc-NTuple{7, Any}"><code>RetentionParameterEstimator.tR_calc</code></a></li><li><a href="#RetentionParameterEstimator.tR_τR_calc-NTuple{11, Any}"><code>RetentionParameterEstimator.tR_τR_calc</code></a></li><li><a href="#RetentionParameterEstimator.time_unit_conversion_factor-Tuple{Any}"><code>RetentionParameterEstimator.time_unit_conversion_factor</code></a></li></ul><h2 id="Detailed-API"><a class="docs-heading-anchor" href="#Detailed-API">Detailed API</a><a id="Detailed-API-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-API" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.Program-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.Program-Tuple{Any, Any, Any}"><code>RetentionParameterEstimator.Program</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">Program(TP, FpinP, L; pout=&quot;vacuum&quot;, time_unit=&quot;min&quot;)</code></pre><p>Construct the structure <code>Program</code> with conventional formulation (see function <code>conventional_program</code> in <code>GasChromatographySimulator.jl</code>) of programs for the case without a thermal gradient. </p><p><strong>Arguments</strong></p><ul><li><code>TP</code>: conventional formulation of a temperature program. </li><li><code>FpinP</code>: conventional formulation of a Flow (in m³/s) resp. inlet pressure (in Pa(a)) program.</li><li><code>L</code>: Length of the capillary measured in m (meter).</li><li><code>pout</code>: Outlet pressure, &quot;vacuum&quot; (default), &quot;atmosphere&quot; or the outlet pressure in Pa(a).</li><li><code>time_unit</code>: unit of time in the programs, &quot;min&quot;` (default) times are measured in minutes, &quot;s&quot; times are measured in seconds.</li></ul><p>The argument <code>L</code> is used to construct the temperature interpolation <code>T_itp(x,t)</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; Program((40.0, 1.0, 5.0, 280.0, 2.0, 20.0, 320.0, 2.0),
                (400000.0, 10.0, 5000.0, 500000.0, 20.0),
                10.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Load.jl#L5-L26">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.check_measurement-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.check_measurement-Tuple{Any, Any}"><code>RetentionParameterEstimator.check_measurement</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">check_measurement(meas, col_input; min_th=0.1, loss_th=1.0, se_col=true)</code></pre><p>Similar to <code>method_m1</code> (<a href="#RetentionParameterEstimator.method_m1-Tuple{Any, Any}"><code>method_m1</code></a>) estimate the three retention parameters <span>$T_{char}$</span>, <span>$θ_{char}$</span> and <span>$ΔC_p$</span> including standard errors, see <code>stderror</code>. In addition, if the found optimized minima is above a threshold <code>min_th</code>, it is flagged and the squared differences of single measured retention times and calculated retention times above another threshold <code>loss_th</code> are recorded.   </p><p><strong>Arguments</strong></p><ul><li><code>meas</code> ... Tuple with the loaded measurement data, see <a href="#RetentionParameterEstimator.load_chromatograms-Tuple{Any}"><code>load_chromatograms</code></a>.</li><li><code>col_input</code> ... Named tuple with <code>col_input.L</code> the column length in m and <code>col_input.d</code> the column diameter in mm. If this parameter is not gicen, than these parameters are taken from <code>meas</code>. </li><li><code>se_col=true</code> ... If <code>true</code> the standard errors (from the Hessian matrix, see <code>stderror</code>) of the estimated parameters are added as separate columns to the result dataframe. If <code>false</code> the standard errors are added to the values as <code>Masurement</code> type.  </li></ul><p><strong>Output</strong></p><ul><li><code>check</code> ... Boolean. <code>true</code> if all values are below the thresholds, <code>false</code> if not.</li><li><code>msg</code> ... String. Description of <code>check</code></li><li><code>df_flag</code> ... Dataframe containing name of the flagged measurements, solutes and the corresponding mesured and calculated retention times.</li><li><code>index_flag</code> ... Indices of flagged results</li><li><code>res</code> ... Dataframe with the optimized parameters and the found minima.</li><li><code>Telu_max</code> ... The maximum of elution temperatures every solute experiences in the measured programs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L749-L768">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.elution_temperature-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.elution_temperature-Tuple{Any, Any}"><code>RetentionParameterEstimator.elution_temperature</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">elution_temperature(tRs, prog)</code></pre><p>Calculate the elution temperatures from retention times <code>tRs</code> and GC programs <code>prog</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Estimate_Start_Values.jl#L28-L32">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.estimate_parameters-Tuple{Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.estimate_parameters-Tuple{Any}"><code>RetentionParameterEstimator.estimate_parameters</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">estimate_parameters(chrom; method=NewtonTrustRegion(), opt=std_opt, maxiters=10000, maxtime=600.0, mode=&quot;dKcentric&quot;, metric=&quot;squared&quot;)</code></pre><p>Calculate the estimates for the K-centric parameters and (optional) the column diameter.</p><p><strong>Arguments</strong></p><ul><li><code>chrom</code> ... Tuple of the loaded chromatogram, see <a href="#RetentionParameterEstimator.load_chromatograms-Tuple{Any}"><code>load_chromatograms</code></a></li></ul><p><strong>Options</strong></p><ul><li><code>method=NewtonTrustRegion()</code> ... used optimization method</li><li><code>opt=std_opt</code> ... general options, <code>std_opt = GasChromatographySimulator.Options(abstol=1e-8, reltol=1e-5, ng=true, odesys=false)</code></li><li><code>maxiters=10000</code> ... maximum number of iterations for every single optimization</li><li><code>maxtime=600.0</code> ... maximum time for every single optimization</li><li><code>mode=&quot;dKcentric&quot;</code> ... mode of the estimation.    Possible options: <ul><li>&quot;Kcentric_single&quot; ... optimization for the three K-centric retention parameters separatly for every solute</li><li>&quot;Kcentric&quot; ... optimization for the three K-centric retention parameters together for all solutes</li><li>&quot;dKcentric_single&quot; ... optimization for the column diameter and the three K-centric retention parameters separatly for every solute</li><li>&quot;dKcentric&quot; ... optimization for the column diameter and the three K-centric retention parameters together for all solutes</li><li>&quot;d_only&quot; ... optimization for only the column diameter while keeping the K-centric retention parameters fixed (requires fixed parameter values as vectors)</li><li>&quot;d_only&quot; ... optimization for only the column diameter while keeping the K-centric retention parameters fixed (requires fixed parameter values as vectors)</li></ul></li><li><code>metric=&quot;squared&quot;</code> ... used metric for the loss function (&quot;squared&quot; or &quot;abs&quot;)</li></ul><p><strong>Output</strong></p><ul><li><code>df</code> ... DataFrame with the columns <code>Name</code> (solute names), <code>d</code> (estimated column diameter, optional), <code>Tchar</code> (estimated Tchar), <code>θchar</code> (estimated θchar), <code>ΔCp</code> (estimated ΔCp) and <code>min</code> (value of the loss function at the found optima)</li><li><code>sol</code> ... Array of <code>SciMLBase.OptimizationSolution</code> with the results of the optimization with some additional informations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L648-L674">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.estimate_start_parameter-Tuple{DataFrame, Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.estimate_start_parameter-Tuple{DataFrame, Any, Any}"><code>RetentionParameterEstimator.estimate_start_parameter</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">estimate_start_parameter(tRs::DataFrame, col, prog; time_unit=&quot;min&quot;, control=&quot;Pressure&quot;)</code></pre><p>Estimation of initial parameters for <code>Tchar</code>, <code>θchar</code> and <code>ΔCp</code> based on the elution temperatures calculated from the retention times <code>tR</code> and GC programs <code>prog</code> for column <code>col</code>. The initial value of <code>Tchar</code> is estimated from the elution temperatures of the measurements. Based on this estimated <code>Tchar</code> estimates for the initial values of <code>θchar</code> and <code>ΔCp</code> are calculated as     <span>$\theta_{char,init} = 22 \left(\frac{T_{char,init}}{T_{st}}\right)^{0.7} \left(1000\frac{d_f}{d}\right)^{0.09} °C$</span> and     <span>$\Delta C_p = (-52 + 0.34 T_{char,init}) \mathrm{J mol^{-1} K^{-1}}$</span></p><p><strong>Output</strong></p><ul><li><code>Tchar_est</code> ... estimate for initial guess of the characteristic temperature</li><li><code>θchar_est</code> ... estimate for initial guess of θchar</li><li><code>ΔCp_est</code> ... estimate for initial guess of ΔCp</li><li><code>Telu_max</code> ... the maximum of the calculated elution temperatures of the solutes</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Estimate_Start_Values.jl#L147-L166">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.estimate_start_parameter_mean_elu_temp-Tuple{DataFrame, Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.estimate_start_parameter_mean_elu_temp-Tuple{DataFrame, Any, Any}"><code>RetentionParameterEstimator.estimate_start_parameter_mean_elu_temp</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">estimate_start_parameter_mean_elu_temp(tRs::DataFrame, col, prog; time_unit=&quot;min&quot;, control=&quot;Pressure&quot;)</code></pre><p>Estimation of initial parameters for <code>Tchar</code>, <code>θchar</code> and <code>ΔCp</code> based on the elution temperatures calculated from the retention times <code>tR</code> and GC programs <code>prog</code> for column <code>col</code>. This function is used, if the temperature program is not a single ramp heating program. The elution temperatures of all measurements are calculated and the mean value of the elution temperatures is used as the initial characteristic temperature of a substance. Based on this estimated <code>Tchar</code> estimates for the initial values of <code>θchar</code> and <code>ΔCp</code> are calculated as     <span>$\theta_{char,init} = 22 \left(\frac{T_{char,init}}{T_{st}}\right)^{0.7} \left(1000\frac{d_f}{d}\right)^{0.09} °C$</span> and     <span>$\Delta C_p = (-52 + 0.34 T_{char,init}) \mathrm{J mol^{-1} K^{-1}}$</span></p><p><strong>Output</strong></p><ul><li><code>Tchar_est</code> ... estimate for initial guess of the characteristic temperature</li><li><code>θchar_est</code> ... estimate for initial guess of θchar</li><li><code>ΔCp_est</code> ... estimate for initial guess of ΔCp</li><li><code>Telu_max</code> ... the maximum of the calculated elution temperatures of the solutes</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Estimate_Start_Values.jl#L104-L123">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.estimate_start_parameter_single_ramp-Tuple{DataFrame, Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.estimate_start_parameter_single_ramp-Tuple{DataFrame, Any, Any}"><code>RetentionParameterEstimator.estimate_start_parameter_single_ramp</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">estimate_start_parameter_single_ramp(tRs::DataFrame, col, prog; time_unit=&quot;min&quot;, control=&quot;Pressure&quot;)</code></pre><p>Estimation of initial parameters for <code>Tchar</code>, <code>θchar</code> and <code>ΔCp</code> based on the elution temperatures calculated from the retention times <code>tR</code> and GC programs <code>prog</code> for column <code>col</code>. For this function it is assumed, that single ramp heating programs are used. The elution temperatures of all measurements are calculated and than interpolated over the heating rates. For a dimensionless heating rate of 0.6 the elution temperature and the characteristic temperature of a substance are nearly equal. Based on this estimated <code>Tchar</code> estimates for the initial values of <code>θchar</code> and <code>ΔCp</code> are calculated as     <span>$\theta_{char,init} = 22 \left(\frac{T_{char,init}}{T_{st}}\right)^{0.7} \left(1000\frac{d_f}{d}\right)^{0.09} °C$</span> and     <span>$\Delta C_p = (-180 + 0.63 T_{char,init}) \mathrm{J mol^{-1} K^{-1}}$</span></p><p><strong>Output</strong></p><ul><li><code>Tchar_est</code> ... estimate for initial guess of the characteristic temperature</li><li><code>θchar_est</code> ... estimate for initial guess of θchar</li><li><code>ΔCp_est</code> ... estimate for initial guess of ΔCp</li><li><code>Telu_max</code> ... the maximum of the calculated elution temperatures of the solutes</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Estimate_Start_Values.jl#L45-L64">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.load_chromatograms-Tuple{Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.load_chromatograms-Tuple{Any}"><code>RetentionParameterEstimator.load_chromatograms</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">load_chromatograms(file; delim=&quot;;&quot;)</code></pre><p>Loading of the chromatographic data (column information, GC program information, retention time information, see also &quot;Structure of input data&quot;) from a file.</p><p><strong>Arguments</strong></p><ul><li><code>file</code> ... path to the file.</li><li><code>delim=&quot;;&quot;</code> ... Delimiter for the imported .csv file.</li></ul><p><strong>Output</strong></p><p>A tuple of the following quantities:</p><ul><li><code>col</code> ... settings of the column as <code>GasChromatographySimulator.Column</code> structure.</li><li><code>prog</code> ... Array of the GC programs as <code>GasChromatographySimulator.Program</code> structure.</li><li><code>tRs</code> ... DataFrame of the retention times.</li><li><code>solute_names</code> ... Vector of the solute names.</li><li><code>pout</code> ... outlet pressure (detector pressure), &quot;vacuum&quot; or &quot;atmospheric&quot;. </li><li><code>time_unit</code> ... unit of time scale used in the retention times and GC programs, &quot;min&quot; or &quot;s&quot;.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Load.jl#L92-L109">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.load_chromatograms-Tuple{Dict{Any, Any}}"><a class="docstring-binding" href="#RetentionParameterEstimator.load_chromatograms-Tuple{Dict{Any, Any}}"><code>RetentionParameterEstimator.load_chromatograms</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">load_chromatograms(file::Dict{Any, Any}; path=joinpath(dirname(pwd()), &quot;data&quot;, &quot;exp_pro&quot;))</code></pre><p>Loading of the chromatographic data (column information, GC program information, retention time information, see also &quot;Structure of input data&quot;) from a file selected by the FilePicker in a Pluto notebook.</p><p><strong>Arguments</strong></p><ul><li><code>file</code> ... file dictionary from the FilePicker.</li><li><code>path</code> ... if the temperature programs are defined by measured temperatures over time, define the path to these files.</li></ul><p><strong>Output</strong></p><p>A tuple of the following quantities:</p><ul><li><code>col</code> ... settings of the column as <code>GasChromatographySimulator.Column</code> structure.</li><li><code>prog</code> ... Array of the GC programs as <code>GasChromatographySimulator.Program</code> structure.</li><li><code>tRs</code> ... DataFrame of the retention times.</li><li><code>solute_names</code> ... Vector of the solute names.</li><li><code>pout</code> ... outlet pressure (detector pressure), &quot;vacuum&quot; or &quot;atmospheric&quot;. </li><li><code>time_unit</code> ... unit of time scale used in the retention times and GC programs, &quot;min&quot; or &quot;s&quot;.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Load.jl#L149-L166">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.loss-NTuple{8, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.loss-NTuple{8, Any}"><code>RetentionParameterEstimator.loss</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">loss(tR, Tchar, θchar, ΔCp, L, d, prog, gas; opt=std_opt, metric=&quot;squared&quot;)</code></pre><p>Loss function as sum of squares of the residuals between the measured and calculated retention times.</p><p><strong>Arguments</strong></p><ul><li><code>tR</code> ... mxn-array of the measured retention times in seconds.</li><li><code>Tchar</code> ... n-array of characteristic temperatures in K.</li><li><code>θchar</code> ... n-array of characteristic constants in °C.</li><li><code>ΔCp</code> ... n-array of the change of adiabatic heat capacity in J mol^-1 K^-1.</li><li><code>L</code> ... number of the length of the column in m.</li><li><code>d</code> ... number of the diameters of the column in m.</li><li><code>prog</code> ... m-array of structure GasChromatographySimulator.Programs containing the definition of the GC-programs.</li><li><code>gas</code> ... string of name of the mobile phase gas. </li></ul><p><strong>Output</strong></p><p>The output is a tuple of the following quantites:</p><ul><li><code>sum((tR.-tRcalc).^2)</code> ... sum of the squared residuals over m GC-programs and n solutes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Loss.jl#L64-L82">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.loss-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Vector{String}, Any, Any, Vector{&lt;:GasChromatographySimulator.Program}, Any}} where T&lt;:Number"><a class="docstring-binding" href="#RetentionParameterEstimator.loss-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Vector{String}, Any, Any, Vector{&lt;:GasChromatographySimulator.Program}, Any}} where T&lt;:Number"><code>RetentionParameterEstimator.loss</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">loss(tR::Array{T, 1}, Tchar, θchar, ΔCp, substance_list::Array{String, 1}, L, d, prog::Array{GasChromatographySimulator.Program, 1}, gas; opt=std_opt, metric=&quot;squared&quot;) where T&lt;:Number</code></pre><p>Calculates the loss between the measured retention times <code>tR</code> and the calculated retention times <code>tRcalc</code> for a list (vector) of substances.</p><p><strong>Arguments</strong></p><ul><li><code>tR::Array{T, 1}</code>: Array of measured retention times.</li><li><code>Tchar</code>: Array of characteristic temperatures for each substance.</li><li><code>θchar</code>: Array of characteristic parameters for each substance.</li><li><code>ΔCp</code>: Array of heat capacity changes for each substance.</li><li><code>substance_list::Array{String, 1}</code>: List of substances.</li><li><code>L</code>: Length of the column.</li><li><code>d</code>: Diameter of the column.</li><li><code>prog::Array{GasChromatographySimulator.Program, 1}</code>: Array of programs for gas chromatography.</li><li><code>gas</code>: The gas used.</li><li><code>opt=std_opt</code>: (Optional) Options for calculating retention times.</li><li><code>metric=&quot;squared&quot;</code>: (Optional) The loss metric to use. Can be &quot;abs&quot; for absolute loss or &quot;squared&quot; for squared loss.</li></ul><p><strong>Return Value</strong></p><ul><li><code>l</code>: The calculated loss value.</li></ul><p><strong>Errors</strong></p><ul><li>Throws an error if the lengths of <code>tR</code>, <code>substance_list</code>, and <code>prog</code> do not match.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Loss.jl#L110-L133">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.match_stderrors_by_name-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.match_stderrors_by_name-Tuple{Any, Any}"><code>RetentionParameterEstimator.match_stderrors_by_name</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">match_stderrors_by_name(res, stderrors)</code></pre><p>Match standard errors to results by substance name, ensuring correct association regardless of DataFrame order. Returns arrays of standard errors in the same order as <code>res.Name</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L1240-L1245">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.match_stderrors_m3_by_name-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.match_stderrors_m3_by_name-Tuple{Any, Any}"><code>RetentionParameterEstimator.match_stderrors_m3_by_name</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">match_stderrors_m3_by_name(res, stderrors)</code></pre><p>Match standard errors from stderror_m3 to results by substance name, ensuring correct association regardless of DataFrame order. Returns arrays of standard errors in the same order as <code>res.Name</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L1351-L1356">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.method_m1-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.method_m1-Tuple{Any, Any}"><code>RetentionParameterEstimator.method_m1</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">method_m1(meas, col_input; se_col=true, parallel=false)</code></pre><p>Estimation of the three retention parameters <span>$T_{char}$</span>, <span>$θ_{char}$</span> and <span>$ΔC_p$</span> including standard errors, see <code>stderror</code>.</p><p><strong>Arguments</strong></p><ul><li><code>meas</code> ... Tuple with the loaded measurement data, see <a href="#RetentionParameterEstimator.load_chromatograms-Tuple{Any}"><code>load_chromatograms</code></a>.</li><li><code>col_input</code> ... Named tuple with <code>col_input.L</code> the column length in m and <code>col_input.d</code> the column diameter in mm. </li><li><code>se_col=true</code> ... If <code>true</code> the standard errors (from the Hessian matrix, see <code>stderror</code>) of the estimated parameters are added as separate columns to the result dataframe. If <code>false</code> the standard errors are added to the values as <code>Masurement</code> type.  </li><li><code>parallel=false</code> ... If <code>true</code>, use parallelization for per-substance optimizations and standard error calculations (requires Julia to be started with multiple threads, e.g., <code>julia -t 4</code>).</li></ul><p><strong>Output</strong></p><ul><li><code>res</code> ... Dataframe with the optimized parameters and the found minima.</li><li><code>Telu_max</code> ... The maximum of elution temperatures every solute experiences in the measured programs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L819-L833">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.method_m2-Tuple{Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.method_m2-Tuple{Any}"><code>RetentionParameterEstimator.method_m2</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">method_m2(meas; se_col=true, parallel=false)</code></pre><p>Estimation of the column diameter <span>$d$</span> and three retention parameters <span>$T_{char}$</span>, <span>$θ_{char}$</span> and <span>$Δ C_p$</span> including standard errors, see <code>stderror</code>. In a first run all four parameters are estimated for every substance separatly, resulting in different optimized column diameters. The mean value of the column diameter is used for  a second optimization using this mean diameter and optimize the remainig thre retention parameters <span>$T_{char}$</span>, <span>$θ_{char}$</span> and <span>$Δ C_p$</span>.</p><p><strong>Arguments</strong></p><ul><li><code>meas</code> ... Tuple with the loaded measurement data, see <a href="#RetentionParameterEstimator.load_chromatograms-Tuple{Any}"><code>load_chromatograms</code></a>.</li><li><code>se_col=true</code> ... If <code>true</code> the standard errors (from the Hessian matrix, see <code>stderror</code>) of the estimated parameters are added as separate columns to the result dataframe. If <code>false</code> the standard errors are added to the values as <code>Masurement</code> type.  </li><li><code>parallel=false</code> ... If <code>true</code>, use parallelization for per-substance optimizations and standard error calculations (requires Julia to be started with multiple threads, e.g., <code>julia -t 4</code>).</li></ul><p><strong>Output</strong></p><ul><li><code>res</code> ... Dataframe with the optimized parameters and the found minima.</li><li><code>Telu_max</code> ... The maximum of elution temperatures every solute experiences in the measured programs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L860-L875">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.method_m3-Tuple{Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.method_m3-Tuple{Any}"><code>RetentionParameterEstimator.method_m3</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">method_m3(meas; se_col=true, parallel=false)</code></pre><p>Estimation of the column diameter <span>$d$</span> and three retention parameters <span>$T_{char}$</span>, <span>$θ_{char}$</span> and <span>$Δ C_p$</span> including standard errors, see <code>stderror</code>. Brute-force method, where all parameters (<code>3n+1</code> for <code>n</code> substances) are estimate in one optimization. </p><p>ATTENTION: This method can take long time to finish. The more substances, the longer it takes.</p><p><strong>Arguments</strong></p><ul><li><code>meas</code> ... Tuple with the loaded measurement data, see <a href="#RetentionParameterEstimator.load_chromatograms-Tuple{Any}"><code>load_chromatograms</code></a>.</li><li><code>se_col=true</code> ... If <code>true</code> the standard errors (from the Hessian matrix, see <code>stderror</code>) of the estimated parameters are added as separate columns to the result dataframe. If <code>false</code> the standard errors are added to the values as <code>Masurement</code> type.  </li><li><code>parallel=false</code> ... If <code>true</code>, use parallelization for standard error calculations (requires Julia to be started with multiple threads, e.g., <code>julia -t 4</code>). Note: The main optimization cannot be parallelized as it&#39;s a single joint optimization.</li></ul><p><strong>Output</strong></p><ul><li><code>res</code> ... Dataframe with the optimized parameters and the found minima.</li><li><code>Telu_max</code> ... The maximum of elution temperatures every solute experiences in the measured programs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L935-L951">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.method_m4-Tuple{Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.method_m4-Tuple{Any}"><code>RetentionParameterEstimator.method_m4</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">method_m4(meas; se_col=true, method=NewtonTrustRegion(), opt=std_opt, maxiters=10000, maxtime=600.0, max_alternating_iters=10, tol=1e-6, parallel=false)</code></pre><p>Estimation of the column diameter <span>$d$</span> and three retention parameters <span>$T_{char}$</span>, <span>$θ_{char}$</span> and <span>$Δ C_p$</span> including standard errors, see <code>stderror</code>. Uses alternating/block coordinate descent optimization:</p><ol><li>Initialize <code>d</code> from a quick estimate (mean of <code>dKcentric_single</code> results with reduced iterations)</li><li><strong>Block 1</strong>: Optimize <code>d</code> (1D optimization) while fixing substance parameters</li><li><strong>Block 2</strong>: Optimize substance parameters (parallelizable) while fixing <code>d</code></li><li>Iterate steps 2-3 until convergence</li></ol><p>This approach properly enforces that <code>d</code> is the same for all substances and is more efficient than joint optimization for many substances (&gt;10).</p><p><strong>Arguments</strong></p><ul><li><code>meas</code> ... Tuple with the loaded measurement data, see <a href="#RetentionParameterEstimator.load_chromatograms-Tuple{Any}"><code>load_chromatograms</code></a>.</li><li><code>se_col=true</code> ... If <code>true</code> the standard errors (from the Hessian matrix, see <code>stderror</code>) of the estimated parameters are added as separate columns to the result dataframe. If <code>false</code> the standard errors are added to the values as <code>Masurement</code> type.</li><li><code>method=NewtonTrustRegion()</code> ... Optimization method to use.</li><li><code>opt=std_opt</code> ... Options for the ODE solver.</li><li><code>maxiters=10000</code> ... Maximum number of iterations for each optimization.</li><li><code>maxtime=600.0</code> ... Maximum time for each optimization in seconds.</li><li><code>max_alternating_iters=10</code> ... Maximum number of alternating iterations.</li><li><code>tol=1e-6</code> ... Convergence tolerance for <code>d</code> and substance parameters (iteration stops when relative changes in <code>d</code>, <code>Tchar</code>, <code>θchar</code>, and <code>ΔCp</code> are all less than <code>tol</code>).</li><li><code>parallel=false</code> ... If <code>true</code>, use parallelization for per-substance optimizations (Block 2) and standard error calculations (requires Julia to be started with multiple threads, e.g., <code>julia -t 4</code>). This can provide significant speedup for many substances.</li></ul><p><strong>Output</strong></p><ul><li><code>res</code> ... Dataframe with the optimized parameters and the found minima.</li><li><code>Telu_max</code> ... The maximum of elution temperatures every solute experiences in the measured programs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L979-L1005">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.opt_Kcentric-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.opt_Kcentric-Tuple{Any, Any}"><code>RetentionParameterEstimator.opt_Kcentric</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">opt_Kcentric(x, p)</code></pre><p>Function used for optimization of the loss-function in regards to the three K-centric parameters.</p><p><strong>Arguments</strong></p><ul><li><code>x</code> ... 3n-vector of the three K-centric parameters of n solutes. Elements 1:n are Tchar, n+1:2n are θchar and 2n+1:3n are ΔCp values.</li><li><code>p</code> ... vector containing the fixed parameters:<ul><li><code>tR = p[1]</code> ... vector of the measured retention times in seconds.</li><li><code>substance_list = p[2]</code> ... vector of the names of the solutes related to <code>tR</code> and <code>prog</code>.</li><li><code>L = p[3]</code> ... number of the length of the column in m.</li><li><code>d = p[4]</code> ... number of the diameters of the column in m.</li><li><code>prog = p[5]</code> ... vector of structure GasChromatographySimulator.Programs containing the definition of the GC-programs.</li><li><code>opt = p[6]</code> ... struture GasChromatographySimulator.Options containing the settings for options for the simulation.</li><li><code>gas = p[7]</code> ... string of name of the mobile phase gas. </li><li><code>metric = p[8]</code> ... string of the metric used for the loss function (<code>squared</code> or <code>abs</code>). </li></ul></li></ul><p><strong>Output</strong></p><ul><li><code>sum((tR.-tRcalc).^2)</code> ... sum of the squared residuals over m GC-programs and n solutes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L8-L27">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.opt_dKcentric-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.opt_dKcentric-Tuple{Any, Any}"><code>RetentionParameterEstimator.opt_dKcentric</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">opt_dKcentric(x, p)</code></pre><p>Function used for optimization of the loss-function in regards to the colum diameter and the three K-centric parameters.</p><p><strong>Arguments</strong></p><ul><li><code>x</code> ... 1+3n-vector of column diameter and the three K-centric parameters of n solutes. Element 1 is the diameter, 2:n+1 are Tchar, n+2:2n+1 are θchar and 2n+2:3n+1 are ΔCp values.</li><li><code>p</code> ... vector containing the fixed parameters:<ul><li><code>tR = p[1]</code> ... vector of the measured retention times in seconds.</li><li><code>substance_list = p[2]</code> ... vector of the names of the solutes related to <code>tR</code> and <code>prog</code>.</li><li><code>L = p[3]</code> ... number of the length of the column in m.</li><li><code>prog = p[4]</code> ... vector of structure GasChromatographySimulator.Programs containing the definition of the GC-programs.</li><li><code>opt = p[5]</code> ... struture GasChromatographySimulator.Options containing the settings for options for the simulation.</li><li><code>gas = p[6]</code> ... string of name of the mobile phase gas. </li><li><code>metric = p[7]</code> ... string of the metric used for the loss function (<code>squared</code> or <code>abs</code>). </li></ul></li></ul><p><strong>Output</strong></p><ul><li><code>sum((tR.-tRcalc).^2)</code> ... sum of the squared residuals over m GC-programs and n solutes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L178-L196">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.opt_d_only-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.opt_d_only-Tuple{Any, Any}"><code>RetentionParameterEstimator.opt_d_only</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">opt_d_only(x, p)</code></pre><p>Function used for optimization of the loss-function with respect to only the column diameter <code>d</code>, while keeping the K-centric parameters fixed.</p><p><strong>Arguments</strong></p><ul><li><code>x</code> ... 1-element vector containing the column diameter <code>d</code>.</li><li><code>p</code> ... vector containing the fixed parameters:<ul><li><code>tR = p[1]</code> ... vector of the measured retention times in seconds.</li><li><code>substance_list = p[2]</code> ... vector of the names of the solutes related to <code>tR</code> and <code>prog</code>.</li><li><code>Tchar = p[3]</code> ... vector of characteristic temperatures (fixed).</li><li><code>θchar = p[4]</code> ... vector of characteristic constants (fixed).</li><li><code>ΔCp = p[5]</code> ... vector of heat capacity changes (fixed).</li><li><code>L = p[6]</code> ... number of the length of the column in m.</li><li><code>prog = p[7]</code> ... vector of structure GasChromatographySimulator.Programs containing the definition of the GC-programs.</li><li><code>opt = p[8]</code> ... structure GasChromatographySimulator.Options containing the settings for options for the simulation.</li><li><code>gas = p[9]</code> ... string of name of the mobile phase gas.</li><li><code>metric = p[10]</code> ... string of the metric used for the loss function (<code>squared</code> or <code>abs</code>).</li></ul></li></ul><p><strong>Output</strong></p><ul><li>Loss value from the loss function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L289-L310">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.optimize_Kcentric-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Vector{T}, Vector{T}, Vector{T}}} where T&lt;:Number"><a class="docstring-binding" href="#RetentionParameterEstimator.optimize_Kcentric-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Vector{T}, Vector{T}, Vector{T}}} where T&lt;:Number"><code>RetentionParameterEstimator.optimize_Kcentric</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">optimize_Kcentric(tR::Vector{T}, substance_list, col, prog, Tchar_e::Vector{T}, θchar_e::Vector{T}, ΔCp_e::Vector{T}; method=RetentionParameterEstimator.NewtonTrustRegion(), opt=RetentionParameterEstimator.std_opt, maxiters=10000, maxtime=600.0, metric=&quot;squared&quot;) where T&lt;:Number</code></pre><p>Optimize the K-centric retention parameters for a given set of substances, measured retention times and used programs.</p><p><strong>Arguments</strong></p><ul><li><code>tR::Vector{T}</code>: Vector of retention times.</li><li><code>substance_list</code>: List of substances to be optimized.</li><li><code>col</code>: Column characteristics including length <code>L</code>, diameter <code>d</code>, and gas type <code>gas</code>.</li><li><code>prog</code>: Program conditions.</li><li><code>Tchar_e::Vector{T}</code>: Initial estimates for characteristic temperatures.</li><li><code>θchar_e::Vector{T}</code>: Initial estimates for characteristic phase ratios.</li><li><code>ΔCp_e::Vector{T}</code>: Initial estimates for heat capacity changes.</li><li><code>method</code>: Optimization method to be used (default: <code>RetentionParameterEstimator.NewtonTrustRegion()</code>).</li><li><code>opt</code>: Optimization options (default: <code>RetentionParameterEstimator.std_opt</code>).</li><li><code>maxiters</code>: Maximum number of iterations (default: 10000).</li><li><code>maxtime</code>: Maximum time allowed for optimization in seconds (default: 600.0).</li><li><code>metric</code>: Metric to be used for optimization (default: &quot;squared&quot;).</li></ul><p><strong>Returns</strong></p><ul><li><code>opt_sol</code>: The solution of the optimization problem.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L87-L108">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.optimize_dKcentric-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Number, Vector{T}, Vector{T}, Vector{T}}} where T&lt;:Number"><a class="docstring-binding" href="#RetentionParameterEstimator.optimize_dKcentric-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Number, Vector{T}, Vector{T}, Vector{T}}} where T&lt;:Number"><code>RetentionParameterEstimator.optimize_dKcentric</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">optimize_dKcentric(tR::Vector{T}, substance_list, col, prog, Tchar_e::Vector{T}, θchar_e::Vector{T}, ΔCp_e::Vector{T}; method=RetentionParameterEstimator.NewtonTrustRegion(), opt=RetentionParameterEstimator.std_opt, maxiters=10000, maxtime=600.0, metric=&quot;squared&quot;) where T&lt;:Number</code></pre><p>Optimize the column diameter and K-centric retention parameters for a given set of substances, measured retention times and used programs.</p><p><strong>Arguments</strong></p><ul><li><code>tR::Vector{T}</code>: Vector of retention times.</li><li><code>substance_list</code>: List of substances to be optimized.</li><li><code>col</code>: Column characteristics including length <code>L</code> and gas type <code>gas</code>.</li><li><code>prog</code>: Program conditions.</li><li><code>Tchar_e::Vector{T}</code>: Initial estimates for characteristic temperatures.</li><li><code>θchar_e::Vector{T}</code>: Initial estimates for characteristic phase ratios.</li><li><code>ΔCp_e::Vector{T}</code>: Initial estimates for heat capacity changes.</li><li><code>method</code>: Optimization method to be used (default: <code>RetentionParameterEstimator.NewtonTrustRegion()</code>).</li><li><code>opt</code>: Optimization options (default: <code>RetentionParameterEstimator.std_opt</code>).</li><li><code>maxiters</code>: Maximum number of iterations (default: 10000).</li><li><code>maxtime</code>: Maximum time allowed for optimization in seconds (default: 600.0).</li><li><code>metric</code>: Metric to be used for optimization (default: &quot;squared&quot;).</li></ul><p><strong>Returns</strong></p><ul><li><code>opt_sol</code>: The solution of the optimization problem.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L258-L279">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.optimize_d_only-Union{Tuple{T}, Tuple{Vector{T}, Vararg{Any, 8}}} where T&lt;:Number"><a class="docstring-binding" href="#RetentionParameterEstimator.optimize_d_only-Union{Tuple{T}, Tuple{Vector{T}, Vararg{Any, 8}}} where T&lt;:Number"><code>RetentionParameterEstimator.optimize_d_only</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">optimize_d_only(tR::Vector{T}, substance_list, Tchar, θchar, ΔCp, L, prog, gas, d_e; method=RetentionParameterEstimator.NewtonTrustRegion(), opt=RetentionParameterEstimator.std_opt, maxiters=10000, maxtime=600.0, metric=&quot;squared&quot;) where T&lt;:Number</code></pre><p>Optimize only the column diameter <code>d</code> while keeping the K-centric retention parameters fixed.</p><p><strong>Arguments</strong></p><ul><li><code>tR::Vector{T}</code>: Vector of retention times.</li><li><code>substance_list</code>: List of substances.</li><li><code>Tchar</code>: Vector of characteristic temperatures (fixed).</li><li><code>θchar</code>: Vector of characteristic phase ratios (fixed).</li><li><code>ΔCp</code>: Vector of heat capacity changes (fixed).</li><li><code>L</code>: Length of the column in m.</li><li><code>prog</code>: Program conditions.</li><li><code>gas</code>: Gas type.</li><li><code>d_e</code>: Initial estimate for column diameter.</li><li><code>method</code>: Optimization method to be used (default: <code>RetentionParameterEstimator.NewtonTrustRegion()</code>).</li><li><code>opt</code>: Optimization options (default: <code>RetentionParameterEstimator.std_opt</code>).</li><li><code>maxiters</code>: Maximum number of iterations (default: 10000).</li><li><code>maxtime</code>: Maximum time allowed for optimization in seconds (default: 600.0).</li><li><code>metric</code>: Metric to be used for optimization (default: &quot;squared&quot;).</li></ul><p><strong>Returns</strong></p><ul><li><code>d_opt</code>: The optimized column diameter value.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L327-L350">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.prepare_optimization_data-NTuple{4, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.prepare_optimization_data-NTuple{4, Any}"><code>RetentionParameterEstimator.prepare_optimization_data</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">prepare_optimization_data(tRs, solute_names, prog, time_unit)</code></pre><p>Prepare data for optimization by converting time units, extracting retention times, filtering missing values, and creating vectorized program and substance lists.</p><p><strong>Arguments</strong></p><ul><li><code>tRs</code>: DataFrame with retention times (first column is measurement names, subsequent columns are retention times for each solute).</li><li><code>solute_names</code>: Vector of solute names (one per column in <code>tRs</code> after the first column).</li><li><code>prog</code>: Vector of programs (one per measurement/row in <code>tRs</code>).</li><li><code>time_unit</code>: String indicating time unit, either <code>&quot;min&quot;</code> or <code>&quot;s&quot;</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>tRs_</code>: Vector of retention times with missing values filtered out.</li><li><code>prog_</code>: Vector of programs matching the filtered <code>tRs_</code> (expanded to 2D and filtered).</li><li><code>subst_list_</code>: Vector of substance names matching the filtered <code>tRs_</code>.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using RetentionParameterEstimator, DataFrames, GasChromatographySimulator

julia&gt; tRs = DataFrame(measurement=[&quot;meas1&quot;, &quot;meas2&quot;], solute1=[100.0, 200.0], solute2=[150.0, 250.0])
2×3 DataFrame
 Row │ measurement  solute1   solute2  
     │ String       Float64   Float64  
 ─────┼─────────────────────────────────
    1 │ meas1           100.0    150.0
    2 │ meas2           200.0    250.0

julia&gt; solute_names = [&quot;solute1&quot;, &quot;solute2&quot;]
2-element Vector{String}:
 &quot;solute1&quot;
 &quot;solute2&quot;

julia&gt; prog = [GasChromatographySimulator.Program([0.0, 5.0], [40.0, 340.0], [150000.0, 250000.0], &quot;vacuum&quot;, &quot;min&quot;) for _ in 1:2]
2-element Vector{GasChromatographySimulator.Program}:
 GasChromatographySimulator.Program(...)

julia&gt; tRs_, prog_, subst_list_ = RetentionParameterEstimator.prepare_optimization_data(tRs, solute_names, prog, &quot;min&quot;)
([100.0, 200.0, 150.0, 250.0], GasChromatographySimulator.Program[...], [&quot;solute1&quot;, &quot;solute1&quot;, &quot;solute2&quot;, &quot;solute2&quot;])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Misc.jl#L228-L269">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.prepare_single_substance_data-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.prepare_single_substance_data-Tuple{Any, Any, Any}"><code>RetentionParameterEstimator.prepare_single_substance_data</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">prepare_single_substance_data(tR_meas, prog, solute_name)</code></pre><p>Prepare data for single-substance optimization by filtering missing values and creating  vectorized program and substance lists.</p><p><strong>Arguments</strong></p><ul><li><code>tR_meas</code>: 1D array of retention times (already time-unit converted) for a single substance.</li><li><code>prog</code>: Vector of programs (one per measurement).</li><li><code>solute_name</code>: Name of the single substance.</li></ul><p><strong>Returns</strong></p><ul><li><code>tRs_</code>: Vector of retention times with missing values filtered out.</li><li><code>prog_</code>: Vector of programs matching the filtered <code>tRs_</code>.</li><li><code>subst_list_</code>: Vector with repeated substance name matching the filtered <code>tRs_</code>.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using RetentionParameterEstimator, GasChromatographySimulator

julia&gt; tR_meas = [100.0, missing, 200.0, 250.0]
4-element Vector{Union{Missing, Float64}}:
  100.0
   missing
  200.0
  250.0

julia&gt; prog = [GasChromatographySimulator.Program([0.0, 5.0], [40.0, 340.0], [150000.0, 250000.0], &quot;vacuum&quot;, &quot;min&quot;) for _ in 1:4]
4-element Vector{GasChromatographySimulator.Program}:
 GasChromatographySimulator.Program(...)

julia&gt; tRs_, prog_, subst_list_ = RetentionParameterEstimator.prepare_single_substance_data(tR_meas, prog, &quot;solute1&quot;)
([100.0, 200.0, 250.0], GasChromatographySimulator.Program[...], [&quot;solute1&quot;, &quot;solute1&quot;, &quot;solute1&quot;])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Misc.jl#L280-L314">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.prog_list-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.prog_list-Tuple{Any, Any}"><code>RetentionParameterEstimator.prog_list</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">prog_list(prog, tRs)</code></pre><p>Generate a vector of program conditions, excluding rows with missing values in <code>tRs</code>.</p><p><strong>Arguments</strong></p><ul><li><code>prog</code>: A program condition or vector of programs.<ul><li>If a single <code>Program</code>: repeated for all measurements and substances.</li><li>If a <code>Vector{Program}</code>: one program per measurement (length must match number of rows in <code>tRs</code>).</li></ul></li><li><code>tRs</code>: A 2D array where each row corresponds to a set of retention times and columns to different substances.</li></ul><p><strong>Returns</strong></p><ul><li>A vector of program conditions corresponding to non-missing rows in <code>tRs</code>.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using RetentionParameterEstimator, GasChromatographySimulator

julia&gt; tRs = [100.0 150.0; 200.0 250.0]
2×2 Matrix{Float64}:
 100.0  150.0
 200.0  250.0

julia&gt; prog_single = GasChromatographySimulator.Program([0.0, 5.0], [40.0, 340.0], [150000.0, 250000.0], &quot;vacuum&quot;, &quot;min&quot;)
GasChromatographySimulator.Program(...)

julia&gt; prog_vec = [prog_single, prog_single]
2-element Vector{GasChromatographySimulator.Program}:
 GasChromatographySimulator.Program(...)

julia&gt; # Single program (repeated)
       prog_list(prog_single, tRs)
4-element Vector{GasChromatographySimulator.Program}:
 GasChromatographySimulator.Program(...)

julia&gt; # Vector of programs (one per measurement)
       prog_list(prog_vec, tRs)
4-element Vector{GasChromatographySimulator.Program}:
 GasChromatographySimulator.Program(...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Misc.jl#L134-L174">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.reference_holdup_time-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.reference_holdup_time-Tuple{Any, Any}"><code>RetentionParameterEstimator.reference_holdup_time</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">reference_holdup_time(prog, L, d, gas; control=&quot;Pressure&quot;)</code></pre><p>Calculate the reference holdup time for the GC program <code>prog</code> for a column with length <code>L</code> and diameter <code>d</code> and <code>gas</code> as mobile phase. The reference holdup time is the holdup time at the reference temperature 150°C.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Estimate_Start_Values.jl#L3-L7">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.separate_error_columns-Tuple{Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.separate_error_columns-Tuple{Any}"><code>RetentionParameterEstimator.separate_error_columns</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">separate_error_columns(res)</code></pre><p>If the result dataframe <code>res</code> contains columns with <code>Measurements</code> typed values, these columns will be split in two. The first column contains the value and uses the original column name. The second column contains the uncertainty and the name of the column is the original name with an added &quot;_uncertainty&quot;. If the column is not of the <code>Measurements</code> type, it will be copied as is for the new dataframe.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Misc.jl#L94-L98">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.stderror_m3-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.stderror_m3-Tuple{Any, Any}"><code>RetentionParameterEstimator.stderror_m3</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">stderror_m3(meas, res; opt=std_opt, metric=&quot;squared&quot;, parallel=false)</code></pre><p>Calculation of the standard error of the found optimized parameters (including column diameter <code>d</code>) using the hessian matrix at the optima. Used for <code>method_m3</code> which optimizes all parameters jointly.</p><p><strong>Attention</strong></p><p>The used loss-function is hard coded in the function <code>opt_dKcentric</code> and has to be changed if another loss-function is used.</p><p><strong>Arguments</strong></p><ul><li><code>meas</code> ... Tuple with the loaded measurement data, see <a href="#RetentionParameterEstimator.load_chromatograms-Tuple{Any}"><code>load_chromatograms</code></a>.</li><li><code>res</code> ... Dataframe with the result of the optimization, see <a href="#RetentionParameterEstimator.estimate_parameters-Tuple{Any}"><code>estimate_parameters</code></a>.</li></ul><p>Optional parameters:</p><ul><li><code>opt=std_opt</code> ... Options for the ODE solver.</li><li><code>metric=&quot;squared&quot;</code> ... Metric used for the loss function (<code>&quot;squared&quot;</code> or <code>&quot;abs&quot;</code>).</li><li><code>parallel=false</code> ... If <code>true</code>, use parallelization for standard error calculations (requires Julia to be started with multiple threads, e.g., <code>julia -t 4</code>).</li></ul><p><strong>Output</strong></p><ul><li><code>stderrors</code> ... Dataframe with the standard errors of the optimized parameters (including <code>d</code>).</li><li><code>Hessian</code> ... The hessian matrix at the found optima. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Optimization.jl#L1267-L1288">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.substance_list-Tuple{Any, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.substance_list-Tuple{Any, Any}"><code>RetentionParameterEstimator.substance_list</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">substance_list(substance_names, tRs)</code></pre><p>Generate a vector of substance names, excluding rows with missing values in <code>tRs</code>.</p><p><strong>Arguments</strong></p><ul><li><code>substance_names</code>: A vector of substance names.</li><li><code>tRs</code>: A 2D array where each row corresponds to a set of retention times and columns to different substances.</li></ul><p><strong>Returns</strong></p><ul><li>A vector of substance names corresponding to non-missing rows in <code>tRs</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Misc.jl#L112-L123">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.tR_calc-NTuple{7, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.tR_calc-NTuple{7, Any}"><code>RetentionParameterEstimator.tR_calc</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">tR_calc(Tchar, θchar, ΔCp, L, d, prog, gas; opt=std_opt)</code></pre><p>Calculates the retention time tR for a solute with the K-centric parameters <code>Tchar</code> <code>θchar</code> and <code>ΔCp</code> for a column with length <code>L</code>, internal diameter <code>d</code>, the (conventional) program <code>prog</code>, options <code>opt</code> and mobile phase <code>gas</code>. For this calculation only the ODE for the migration of a solute in a GC column is solved, using the function <code>GasChromatographySimulator.solving_migration</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Loss.jl#L3-L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.tR_τR_calc-NTuple{11, Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.tR_τR_calc-NTuple{11, Any}"><code>RetentionParameterEstimator.tR_τR_calc</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">tR_τR_calc(Tchar, θchar, ΔCp, L, d, df, prog, Cag, t₀, τ₀, gas; opt=std_opt)</code></pre><p>Calculates the retention time tR for a solute with the K-centric parameters <code>Tchar</code> <code>θchar</code> and <code>ΔCp</code> for a column with length <code>L</code>, internal diameter <code>d</code>, film thickness <code>df</code>, the (conventional) program <code>prog</code>, diffusirivity coefficient <code>Cag</code>, start time <code>t₀</code>, initial peak width <code>τ₀</code>, options <code>opt</code> and mobile phase <code>gas</code>. For this calculation the ODE-system for the migration of a solute and peak width in a GC column is solved, using the function <code>GasChromatographySimulator.solving_odesystem_r</code>. The result is a tuple of retention time <code>tR</code> and peak width <code>τR</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Loss.jl#L49-L55">source</a></section></details></article><article><details class="docstring" open="true"><summary id="RetentionParameterEstimator.time_unit_conversion_factor-Tuple{Any}"><a class="docstring-binding" href="#RetentionParameterEstimator.time_unit_conversion_factor-Tuple{Any}"><code>RetentionParameterEstimator.time_unit_conversion_factor</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">time_unit_conversion_factor(time_unit)</code></pre><p>Get the conversion factor for time units.</p><p><strong>Arguments</strong></p><ul><li><code>time_unit</code>: String indicating time unit, either <code>&quot;min&quot;</code> or <code>&quot;s&quot;</code>.</li></ul><p><strong>Returns</strong></p><ul><li>Conversion factor: <code>60.0</code> for <code>&quot;min&quot;</code>, <code>1.0</code> for <code>&quot;s&quot;</code> (or any other value).</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using RetentionParameterEstimator

julia&gt; RetentionParameterEstimator.time_unit_conversion_factor(&quot;min&quot;)
60.0

julia&gt; RetentionParameterEstimator.time_unit_conversion_factor(&quot;s&quot;)
1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GasChromatographyToolbox/RetentionParameterEstimator.jl/blob/6d5c2b42a5b4d31423c4273d1748fc8bd24284cf/src/Misc.jl#L197-L218">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 28 January 2026 14:26">Wednesday 28 January 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
