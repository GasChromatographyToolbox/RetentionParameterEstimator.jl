var documenterSearchIndex = {"docs":
[{"location":"#RetentionParameterEstimator.jl","page":"Home","title":"RetentionParameterEstimator.jl","text":"Documentation for RetentionParameterEstimator.jl\n\nRetentionParameterEstimator.jl","category":"section"},{"location":"docstrings/#Module-Index","page":"Docstrings","title":"Module Index","text":"Modules = [RetentionParameterEstimator]\nOrder   = [:constant, :type, :function, :macro]","category":"section"},{"location":"docstrings/#Detailed-API","page":"Docstrings","title":"Detailed API","text":"","category":"section"},{"location":"docstrings/#RetentionParameterEstimator.Program-Tuple{Any, Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.Program","text":"Program(TP, FpinP, L; pout=\"vacuum\", time_unit=\"min\")\n\nConstruct the structure Program with conventional formulation (see function conventional_program in GasChromatographySimulator.jl) of programs for the case without a thermal gradient. \n\nArguments\n\nTP: conventional formulation of a temperature program. \nFpinP: conventional formulation of a Flow (in m³/s) resp. inlet pressure (in Pa(a)) program.\nL: Length of the capillary measured in m (meter).\npout: Outlet pressure, \"vacuum\" (default), \"atmosphere\" or the outlet pressure in Pa(a).\ntime_unit: unit of time in the programs, \"min\"` (default) times are measured in minutes, \"s\" times are measured in seconds.\n\nThe argument L is used to construct the temperature interpolation T_itp(x,t).\n\nExamples\n\njulia> Program((40.0, 1.0, 5.0, 280.0, 2.0, 20.0, 320.0, 2.0),\n                (400000.0, 10.0, 5000.0, 500000.0, 20.0),\n                10.0)\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.check_measurement-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.check_measurement","text":"check_measurement(meas, col_input; min_th=0.1, loss_th=1.0, se_col=true)\n\nSimilar to method_m1 (method_m1) estimate the three retention parameters T_char, θ_char and ΔC_p including standard errors, see stderror. In addition, if the found optimized minima is above a threshold min_th, it is flagged and the squared differences of single measured retention times and calculated retention times above another threshold loss_th are recorded.   \n\nArguments\n\nmeas ... Tuple with the loaded measurement data, see load_chromatograms.\ncol_input ... Named tuple with col_input.L the column length in m and col_input.d the column diameter in mm. If this parameter is not gicen, than these parameters are taken from meas. \nse_col=true ... If true the standard errors (from the Hessian matrix, see stderror) of the estimated parameters are added as separate columns to the result dataframe. If false the standard errors are added to the values as Masurement type.  \n\nOutput\n\ncheck ... Boolean. true if all values are below the thresholds, false if not.\nmsg ... String. Description of check\ndf_flag ... Dataframe containing name of the flagged measurements, solutes and the corresponding mesured and calculated retention times.\nindex_flag ... Indices of flagged results\nres ... Dataframe with the optimized parameters and the found minima.\nTelu_max ... The maximum of elution temperatures every solute experiences in the measured programs.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.elution_temperature-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.elution_temperature","text":"elution_temperature(tRs, prog)\n\nCalculate the elution temperatures from retention times tRs and GC programs prog.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.estimate_parameters-Tuple{Any}","page":"Docstrings","title":"RetentionParameterEstimator.estimate_parameters","text":"estimate_parameters(chrom; method=NewtonTrustRegion(), opt=std_opt, maxiters=10000, maxtime=600.0, mode=\"dKcentric\", metric=\"squared\")\n\nCalculate the estimates for the K-centric parameters and (optional) the column diameter.\n\nArguments\n\nchrom ... Tuple of the loaded chromatogram, see load_chromatograms\n\nOptions\n\nmethod=NewtonTrustRegion() ... used optimization method\nopt=std_opt ... general options, std_opt = GasChromatographySimulator.Options(abstol=1e-8, reltol=1e-5, ng=true, odesys=false)\nmaxiters=10000 ... maximum number of iterations for every single optimization\nmaxtime=600.0 ... maximum time for every single optimization\nmode=\"dKcentric\" ... mode of the estimation.    Possible options: \n\"Kcentric_single\" ... optimization for the three K-centric retention parameters separatly for every solute\n\"Kcentric\" ... optimization for the three K-centric retention parameters together for all solutes\n\"dKcentric_single\" ... optimization for the column diameter and the three K-centric retention parameters separatly for every solute\n\"dKcentric\" ... optimization for the column diameter and the three K-centric retention parameters together for all solutes\n\"d_only\" ... optimization for only the column diameter while keeping the K-centric retention parameters fixed (requires fixed parameter values as vectors)\n\"d_only\" ... optimization for only the column diameter while keeping the K-centric retention parameters fixed (requires fixed parameter values as vectors)\nmetric=\"squared\" ... used metric for the loss function (\"squared\" or \"abs\")\n\nOutput\n\ndf ... DataFrame with the columns Name (solute names), d (estimated column diameter, optional), Tchar (estimated Tchar), θchar (estimated θchar), ΔCp (estimated ΔCp) and min (value of the loss function at the found optima)\nsol ... Array of SciMLBase.OptimizationSolution with the results of the optimization with some additional informations.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.estimate_start_parameter-Tuple{DataFrame, Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.estimate_start_parameter","text":"estimate_start_parameter(tRs::DataFrame, col, prog; time_unit=\"min\", control=\"Pressure\")\n\nEstimation of initial parameters for Tchar, θchar and ΔCp based on the elution temperatures calculated from the retention times tR and GC programs prog for column col. The initial value of Tchar is estimated from the elution temperatures of the measurements. Based on this estimated Tchar estimates for the initial values of θchar and ΔCp are calculated as     theta_charinit = 22 left(fracT_charinitT_stright)^07 left(1000fracd_fdright)^009 C and     Delta C_p = (-52 + 034 T_charinit) mathrmJ mol^-1 K^-1\n\nOutput\n\nTchar_est ... estimate for initial guess of the characteristic temperature\nθchar_est ... estimate for initial guess of θchar\nΔCp_est ... estimate for initial guess of ΔCp\nTelu_max ... the maximum of the calculated elution temperatures of the solutes\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.estimate_start_parameter_mean_elu_temp-Tuple{DataFrame, Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.estimate_start_parameter_mean_elu_temp","text":"estimate_start_parameter_mean_elu_temp(tRs::DataFrame, col, prog; time_unit=\"min\", control=\"Pressure\")\n\nEstimation of initial parameters for Tchar, θchar and ΔCp based on the elution temperatures calculated from the retention times tR and GC programs prog for column col. This function is used, if the temperature program is not a single ramp heating program. The elution temperatures of all measurements are calculated and the mean value of the elution temperatures is used as the initial characteristic temperature of a substance. Based on this estimated Tchar estimates for the initial values of θchar and ΔCp are calculated as     theta_charinit = 22 left(fracT_charinitT_stright)^07 left(1000fracd_fdright)^009 C and     Delta C_p = (-52 + 034 T_charinit) mathrmJ mol^-1 K^-1\n\nOutput\n\nTchar_est ... estimate for initial guess of the characteristic temperature\nθchar_est ... estimate for initial guess of θchar\nΔCp_est ... estimate for initial guess of ΔCp\nTelu_max ... the maximum of the calculated elution temperatures of the solutes\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.estimate_start_parameter_single_ramp-Tuple{DataFrame, Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.estimate_start_parameter_single_ramp","text":"estimate_start_parameter_single_ramp(tRs::DataFrame, col, prog; time_unit=\"min\", control=\"Pressure\")\n\nEstimation of initial parameters for Tchar, θchar and ΔCp based on the elution temperatures calculated from the retention times tR and GC programs prog for column col. For this function it is assumed, that single ramp heating programs are used. The elution temperatures of all measurements are calculated and than interpolated over the heating rates. For a dimensionless heating rate of 0.6 the elution temperature and the characteristic temperature of a substance are nearly equal. Based on this estimated Tchar estimates for the initial values of θchar and ΔCp are calculated as     theta_charinit = 22 left(fracT_charinitT_stright)^07 left(1000fracd_fdright)^009 C and     Delta C_p = (-180 + 063 T_charinit) mathrmJ mol^-1 K^-1\n\nOutput\n\nTchar_est ... estimate for initial guess of the characteristic temperature\nθchar_est ... estimate for initial guess of θchar\nΔCp_est ... estimate for initial guess of ΔCp\nTelu_max ... the maximum of the calculated elution temperatures of the solutes\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.load_chromatograms-Tuple{Any}","page":"Docstrings","title":"RetentionParameterEstimator.load_chromatograms","text":"load_chromatograms(file; delim=\";\")\n\nLoading of the chromatographic data (column information, GC program information, retention time information, see also \"Structure of input data\") from a file.\n\nArguments\n\nfile ... path to the file.\ndelim=\";\" ... Delimiter for the imported .csv file.\n\nOutput\n\nA tuple of the following quantities:\n\ncol ... settings of the column as GasChromatographySimulator.Column structure.\nprog ... Array of the GC programs as GasChromatographySimulator.Program structure.\ntRs ... DataFrame of the retention times.\nsolute_names ... Vector of the solute names.\npout ... outlet pressure (detector pressure), \"vacuum\" or \"atmospheric\". \ntime_unit ... unit of time scale used in the retention times and GC programs, \"min\" or \"s\".\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.load_chromatograms-Tuple{Dict{Any, Any}}","page":"Docstrings","title":"RetentionParameterEstimator.load_chromatograms","text":"load_chromatograms(file::Dict{Any, Any}; path=joinpath(dirname(pwd()), \"data\", \"exp_pro\"))\n\nLoading of the chromatographic data (column information, GC program information, retention time information, see also \"Structure of input data\") from a file selected by the FilePicker in a Pluto notebook.\n\nArguments\n\nfile ... file dictionary from the FilePicker.\npath ... if the temperature programs are defined by measured temperatures over time, define the path to these files.\n\nOutput\n\nA tuple of the following quantities:\n\ncol ... settings of the column as GasChromatographySimulator.Column structure.\nprog ... Array of the GC programs as GasChromatographySimulator.Program structure.\ntRs ... DataFrame of the retention times.\nsolute_names ... Vector of the solute names.\npout ... outlet pressure (detector pressure), \"vacuum\" or \"atmospheric\". \ntime_unit ... unit of time scale used in the retention times and GC programs, \"min\" or \"s\".\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.loss-NTuple{8, Any}","page":"Docstrings","title":"RetentionParameterEstimator.loss","text":"loss(tR, Tchar, θchar, ΔCp, L, d, prog, gas; opt=std_opt, metric=\"squared\")\n\nLoss function as sum of squares of the residuals between the measured and calculated retention times.\n\nArguments\n\ntR ... mxn-array of the measured retention times in seconds.\nTchar ... n-array of characteristic temperatures in K.\nθchar ... n-array of characteristic constants in °C.\nΔCp ... n-array of the change of adiabatic heat capacity in J mol^-1 K^-1.\nL ... number of the length of the column in m.\nd ... number of the diameters of the column in m.\nprog ... m-array of structure GasChromatographySimulator.Programs containing the definition of the GC-programs.\ngas ... string of name of the mobile phase gas. \n\nOutput\n\nThe output is a tuple of the following quantites:\n\nsum((tR.-tRcalc).^2) ... sum of the squared residuals over m GC-programs and n solutes.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.loss-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Vector{String}, Any, Any, Vector{<:GasChromatographySimulator.Program}, Any}} where T<:Number","page":"Docstrings","title":"RetentionParameterEstimator.loss","text":"loss(tR::Array{T, 1}, Tchar, θchar, ΔCp, substance_list::Array{String, 1}, L, d, prog::Array{GasChromatographySimulator.Program, 1}, gas; opt=std_opt, metric=\"squared\") where T<:Number\n\nCalculates the loss between the measured retention times tR and the calculated retention times tRcalc for a list (vector) of substances.\n\nArguments\n\ntR::Array{T, 1}: Array of measured retention times.\nTchar: Array of characteristic temperatures for each substance.\nθchar: Array of characteristic parameters for each substance.\nΔCp: Array of heat capacity changes for each substance.\nsubstance_list::Array{String, 1}: List of substances.\nL: Length of the column.\nd: Diameter of the column.\nprog::Array{GasChromatographySimulator.Program, 1}: Array of programs for gas chromatography.\ngas: The gas used.\nopt=std_opt: (Optional) Options for calculating retention times.\nmetric=\"squared\": (Optional) The loss metric to use. Can be \"abs\" for absolute loss or \"squared\" for squared loss.\n\nReturn Value\n\nl: The calculated loss value.\n\nErrors\n\nThrows an error if the lengths of tR, substance_list, and prog do not match.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.match_stderrors_by_name-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.match_stderrors_by_name","text":"match_stderrors_by_name(res, stderrors)\n\nMatch standard errors to results by substance name, ensuring correct association regardless of DataFrame order. Returns arrays of standard errors in the same order as res.Name.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.match_stderrors_m3_by_name-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.match_stderrors_m3_by_name","text":"match_stderrors_m3_by_name(res, stderrors)\n\nMatch standard errors from stderror_m3 to results by substance name, ensuring correct association regardless of DataFrame order. Returns arrays of standard errors in the same order as res.Name.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.method_m1-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.method_m1","text":"method_m1(meas, col_input; se_col=true, parallel=false)\n\nEstimation of the three retention parameters T_char, θ_char and ΔC_p including standard errors, see stderror.\n\nArguments\n\nmeas ... Tuple with the loaded measurement data, see load_chromatograms.\ncol_input ... Named tuple with col_input.L the column length in m and col_input.d the column diameter in mm. \nse_col=true ... If true the standard errors (from the Hessian matrix, see stderror) of the estimated parameters are added as separate columns to the result dataframe. If false the standard errors are added to the values as Masurement type.  \nparallel=false ... If true, use parallelization for per-substance optimizations and standard error calculations (requires Julia to be started with multiple threads, e.g., julia -t 4).\n\nOutput\n\nres ... Dataframe with the optimized parameters and the found minima.\nTelu_max ... The maximum of elution temperatures every solute experiences in the measured programs.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.method_m2-Tuple{Any}","page":"Docstrings","title":"RetentionParameterEstimator.method_m2","text":"method_m2(meas; se_col=true, parallel=false)\n\nEstimation of the column diameter d and three retention parameters T_char, θ_char and Δ C_p including standard errors, see stderror. In a first run all four parameters are estimated for every substance separatly, resulting in different optimized column diameters. The mean value of the column diameter is used for  a second optimization using this mean diameter and optimize the remainig thre retention parameters T_char, θ_char and Δ C_p.\n\nArguments\n\nmeas ... Tuple with the loaded measurement data, see load_chromatograms.\nse_col=true ... If true the standard errors (from the Hessian matrix, see stderror) of the estimated parameters are added as separate columns to the result dataframe. If false the standard errors are added to the values as Masurement type.  \nparallel=false ... If true, use parallelization for per-substance optimizations and standard error calculations (requires Julia to be started with multiple threads, e.g., julia -t 4).\n\nOutput\n\nres ... Dataframe with the optimized parameters and the found minima.\nTelu_max ... The maximum of elution temperatures every solute experiences in the measured programs.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.method_m3-Tuple{Any}","page":"Docstrings","title":"RetentionParameterEstimator.method_m3","text":"method_m3(meas; se_col=true, parallel=false)\n\nEstimation of the column diameter d and three retention parameters T_char, θ_char and Δ C_p including standard errors, see stderror. Brute-force method, where all parameters (3n+1 for n substances) are estimate in one optimization. \n\nATTENTION: This method can take long time to finish. The more substances, the longer it takes.\n\nArguments\n\nmeas ... Tuple with the loaded measurement data, see load_chromatograms.\nse_col=true ... If true the standard errors (from the Hessian matrix, see stderror) of the estimated parameters are added as separate columns to the result dataframe. If false the standard errors are added to the values as Masurement type.  \nparallel=false ... If true, use parallelization for standard error calculations (requires Julia to be started with multiple threads, e.g., julia -t 4). Note: The main optimization cannot be parallelized as it's a single joint optimization.\n\nOutput\n\nres ... Dataframe with the optimized parameters and the found minima.\nTelu_max ... The maximum of elution temperatures every solute experiences in the measured programs.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.method_m4-Tuple{Any}","page":"Docstrings","title":"RetentionParameterEstimator.method_m4","text":"method_m4(meas; se_col=true, method=NewtonTrustRegion(), opt=std_opt, maxiters=10000, maxtime=600.0, max_alternating_iters=10, tol=1e-6, parallel=false)\n\nEstimation of the column diameter d and three retention parameters T_char, θ_char and Δ C_p including standard errors, see stderror. Uses alternating/block coordinate descent optimization:\n\nInitialize d from a quick estimate (mean of dKcentric_single results with reduced iterations)\nBlock 1: Optimize d (1D optimization) while fixing substance parameters\nBlock 2: Optimize substance parameters (parallelizable) while fixing d\nIterate steps 2-3 until convergence\n\nThis approach properly enforces that d is the same for all substances and is more efficient than joint optimization for many substances (>10).\n\nArguments\n\nmeas ... Tuple with the loaded measurement data, see load_chromatograms.\nse_col=true ... If true the standard errors (from the Hessian matrix, see stderror) of the estimated parameters are added as separate columns to the result dataframe. If false the standard errors are added to the values as Masurement type.\nmethod=NewtonTrustRegion() ... Optimization method to use.\nopt=std_opt ... Options for the ODE solver.\nmaxiters=10000 ... Maximum number of iterations for each optimization.\nmaxtime=600.0 ... Maximum time for each optimization in seconds.\nmax_alternating_iters=10 ... Maximum number of alternating iterations.\ntol=1e-6 ... Convergence tolerance for d and substance parameters (iteration stops when relative changes in d, Tchar, θchar, and ΔCp are all less than tol).\nparallel=false ... If true, use parallelization for per-substance optimizations (Block 2) and standard error calculations (requires Julia to be started with multiple threads, e.g., julia -t 4). This can provide significant speedup for many substances.\n\nOutput\n\nres ... Dataframe with the optimized parameters and the found minima.\nTelu_max ... The maximum of elution temperatures every solute experiences in the measured programs.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.opt_Kcentric-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.opt_Kcentric","text":"opt_Kcentric(x, p)\n\nFunction used for optimization of the loss-function in regards to the three K-centric parameters.\n\nArguments\n\nx ... 3n-vector of the three K-centric parameters of n solutes. Elements 1:n are Tchar, n+1:2n are θchar and 2n+1:3n are ΔCp values.\np ... vector containing the fixed parameters:\ntR = p[1] ... vector of the measured retention times in seconds.\nsubstance_list = p[2] ... vector of the names of the solutes related to tR and prog.\nL = p[3] ... number of the length of the column in m.\nd = p[4] ... number of the diameters of the column in m.\nprog = p[5] ... vector of structure GasChromatographySimulator.Programs containing the definition of the GC-programs.\nopt = p[6] ... struture GasChromatographySimulator.Options containing the settings for options for the simulation.\ngas = p[7] ... string of name of the mobile phase gas. \nmetric = p[8] ... string of the metric used for the loss function (squared or abs). \n\nOutput\n\nsum((tR.-tRcalc).^2) ... sum of the squared residuals over m GC-programs and n solutes.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.opt_dKcentric-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.opt_dKcentric","text":"opt_dKcentric(x, p)\n\nFunction used for optimization of the loss-function in regards to the colum diameter and the three K-centric parameters.\n\nArguments\n\nx ... 1+3n-vector of column diameter and the three K-centric parameters of n solutes. Element 1 is the diameter, 2:n+1 are Tchar, n+2:2n+1 are θchar and 2n+2:3n+1 are ΔCp values.\np ... vector containing the fixed parameters:\ntR = p[1] ... vector of the measured retention times in seconds.\nsubstance_list = p[2] ... vector of the names of the solutes related to tR and prog.\nL = p[3] ... number of the length of the column in m.\nprog = p[4] ... vector of structure GasChromatographySimulator.Programs containing the definition of the GC-programs.\nopt = p[5] ... struture GasChromatographySimulator.Options containing the settings for options for the simulation.\ngas = p[6] ... string of name of the mobile phase gas. \nmetric = p[7] ... string of the metric used for the loss function (squared or abs). \n\nOutput\n\nsum((tR.-tRcalc).^2) ... sum of the squared residuals over m GC-programs and n solutes.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.opt_d_only-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.opt_d_only","text":"opt_d_only(x, p)\n\nFunction used for optimization of the loss-function with respect to only the column diameter d, while keeping the K-centric parameters fixed.\n\nArguments\n\nx ... 1-element vector containing the column diameter d.\np ... vector containing the fixed parameters:\ntR = p[1] ... vector of the measured retention times in seconds.\nsubstance_list = p[2] ... vector of the names of the solutes related to tR and prog.\nTchar = p[3] ... vector of characteristic temperatures (fixed).\nθchar = p[4] ... vector of characteristic constants (fixed).\nΔCp = p[5] ... vector of heat capacity changes (fixed).\nL = p[6] ... number of the length of the column in m.\nprog = p[7] ... vector of structure GasChromatographySimulator.Programs containing the definition of the GC-programs.\nopt = p[8] ... structure GasChromatographySimulator.Options containing the settings for options for the simulation.\ngas = p[9] ... string of name of the mobile phase gas.\nmetric = p[10] ... string of the metric used for the loss function (squared or abs).\n\nOutput\n\nLoss value from the loss function.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.optimize_Kcentric-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Vector{T}, Vector{T}, Vector{T}}} where T<:Number","page":"Docstrings","title":"RetentionParameterEstimator.optimize_Kcentric","text":"optimize_Kcentric(tR::Vector{T}, substance_list, col, prog, Tchar_e::Vector{T}, θchar_e::Vector{T}, ΔCp_e::Vector{T}; method=RetentionParameterEstimator.NewtonTrustRegion(), opt=RetentionParameterEstimator.std_opt, maxiters=10000, maxtime=600.0, metric=\"squared\") where T<:Number\n\nOptimize the K-centric retention parameters for a given set of substances, measured retention times and used programs.\n\nArguments\n\ntR::Vector{T}: Vector of retention times.\nsubstance_list: List of substances to be optimized.\ncol: Column characteristics including length L, diameter d, and gas type gas.\nprog: Program conditions.\nTchar_e::Vector{T}: Initial estimates for characteristic temperatures.\nθchar_e::Vector{T}: Initial estimates for characteristic phase ratios.\nΔCp_e::Vector{T}: Initial estimates for heat capacity changes.\nmethod: Optimization method to be used (default: RetentionParameterEstimator.NewtonTrustRegion()).\nopt: Optimization options (default: RetentionParameterEstimator.std_opt).\nmaxiters: Maximum number of iterations (default: 10000).\nmaxtime: Maximum time allowed for optimization in seconds (default: 600.0).\nmetric: Metric to be used for optimization (default: \"squared\").\n\nReturns\n\nopt_sol: The solution of the optimization problem.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.optimize_dKcentric-Union{Tuple{T}, Tuple{Vector{T}, Any, Any, Any, Number, Vector{T}, Vector{T}, Vector{T}}} where T<:Number","page":"Docstrings","title":"RetentionParameterEstimator.optimize_dKcentric","text":"optimize_dKcentric(tR::Vector{T}, substance_list, col, prog, Tchar_e::Vector{T}, θchar_e::Vector{T}, ΔCp_e::Vector{T}; method=RetentionParameterEstimator.NewtonTrustRegion(), opt=RetentionParameterEstimator.std_opt, maxiters=10000, maxtime=600.0, metric=\"squared\") where T<:Number\n\nOptimize the column diameter and K-centric retention parameters for a given set of substances, measured retention times and used programs.\n\nArguments\n\ntR::Vector{T}: Vector of retention times.\nsubstance_list: List of substances to be optimized.\ncol: Column characteristics including length L and gas type gas.\nprog: Program conditions.\nTchar_e::Vector{T}: Initial estimates for characteristic temperatures.\nθchar_e::Vector{T}: Initial estimates for characteristic phase ratios.\nΔCp_e::Vector{T}: Initial estimates for heat capacity changes.\nmethod: Optimization method to be used (default: RetentionParameterEstimator.NewtonTrustRegion()).\nopt: Optimization options (default: RetentionParameterEstimator.std_opt).\nmaxiters: Maximum number of iterations (default: 10000).\nmaxtime: Maximum time allowed for optimization in seconds (default: 600.0).\nmetric: Metric to be used for optimization (default: \"squared\").\n\nReturns\n\nopt_sol: The solution of the optimization problem.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.optimize_d_only-Union{Tuple{T}, Tuple{Vector{T}, Vararg{Any, 8}}} where T<:Number","page":"Docstrings","title":"RetentionParameterEstimator.optimize_d_only","text":"optimize_d_only(tR::Vector{T}, substance_list, Tchar, θchar, ΔCp, L, prog, gas, d_e; method=RetentionParameterEstimator.NewtonTrustRegion(), opt=RetentionParameterEstimator.std_opt, maxiters=10000, maxtime=600.0, metric=\"squared\") where T<:Number\n\nOptimize only the column diameter d while keeping the K-centric retention parameters fixed.\n\nArguments\n\ntR::Vector{T}: Vector of retention times.\nsubstance_list: List of substances.\nTchar: Vector of characteristic temperatures (fixed).\nθchar: Vector of characteristic phase ratios (fixed).\nΔCp: Vector of heat capacity changes (fixed).\nL: Length of the column in m.\nprog: Program conditions.\ngas: Gas type.\nd_e: Initial estimate for column diameter.\nmethod: Optimization method to be used (default: RetentionParameterEstimator.NewtonTrustRegion()).\nopt: Optimization options (default: RetentionParameterEstimator.std_opt).\nmaxiters: Maximum number of iterations (default: 10000).\nmaxtime: Maximum time allowed for optimization in seconds (default: 600.0).\nmetric: Metric to be used for optimization (default: \"squared\").\n\nReturns\n\nd_opt: The optimized column diameter value.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.prepare_optimization_data-NTuple{4, Any}","page":"Docstrings","title":"RetentionParameterEstimator.prepare_optimization_data","text":"prepare_optimization_data(tRs, solute_names, prog, time_unit)\n\nPrepare data for optimization by converting time units, extracting retention times, filtering missing values, and creating vectorized program and substance lists.\n\nArguments\n\ntRs: DataFrame with retention times (first column is measurement names, subsequent columns are retention times for each solute).\nsolute_names: Vector of solute names (one per column in tRs after the first column).\nprog: Vector of programs (one per measurement/row in tRs).\ntime_unit: String indicating time unit, either \"min\" or \"s\".\n\nReturns\n\ntRs_: Vector of retention times with missing values filtered out.\nprog_: Vector of programs matching the filtered tRs_ (expanded to 2D and filtered).\nsubst_list_: Vector of substance names matching the filtered tRs_.\n\nExamples\n\njulia> using RetentionParameterEstimator, DataFrames, GasChromatographySimulator\n\njulia> tRs = DataFrame(measurement=[\"meas1\", \"meas2\"], solute1=[100.0, 200.0], solute2=[150.0, 250.0])\n2×3 DataFrame\n Row │ measurement  solute1   solute2  \n     │ String       Float64   Float64  \n ─────┼─────────────────────────────────\n    1 │ meas1           100.0    150.0\n    2 │ meas2           200.0    250.0\n\njulia> solute_names = [\"solute1\", \"solute2\"]\n2-element Vector{String}:\n \"solute1\"\n \"solute2\"\n\njulia> prog = [GasChromatographySimulator.Program([0.0, 5.0], [40.0, 340.0], [150000.0, 250000.0], \"vacuum\", \"min\") for _ in 1:2]\n2-element Vector{GasChromatographySimulator.Program}:\n GasChromatographySimulator.Program(...)\n\njulia> tRs_, prog_, subst_list_ = RetentionParameterEstimator.prepare_optimization_data(tRs, solute_names, prog, \"min\")\n([100.0, 200.0, 150.0, 250.0], GasChromatographySimulator.Program[...], [\"solute1\", \"solute1\", \"solute2\", \"solute2\"])\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.prepare_single_substance_data-Tuple{Any, Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.prepare_single_substance_data","text":"prepare_single_substance_data(tR_meas, prog, solute_name)\n\nPrepare data for single-substance optimization by filtering missing values and creating  vectorized program and substance lists.\n\nArguments\n\ntR_meas: 1D array of retention times (already time-unit converted) for a single substance.\nprog: Vector of programs (one per measurement).\nsolute_name: Name of the single substance.\n\nReturns\n\ntRs_: Vector of retention times with missing values filtered out.\nprog_: Vector of programs matching the filtered tRs_.\nsubst_list_: Vector with repeated substance name matching the filtered tRs_.\n\nExamples\n\njulia> using RetentionParameterEstimator, GasChromatographySimulator\n\njulia> tR_meas = [100.0, missing, 200.0, 250.0]\n4-element Vector{Union{Missing, Float64}}:\n  100.0\n   missing\n  200.0\n  250.0\n\njulia> prog = [GasChromatographySimulator.Program([0.0, 5.0], [40.0, 340.0], [150000.0, 250000.0], \"vacuum\", \"min\") for _ in 1:4]\n4-element Vector{GasChromatographySimulator.Program}:\n GasChromatographySimulator.Program(...)\n\njulia> tRs_, prog_, subst_list_ = RetentionParameterEstimator.prepare_single_substance_data(tR_meas, prog, \"solute1\")\n([100.0, 200.0, 250.0], GasChromatographySimulator.Program[...], [\"solute1\", \"solute1\", \"solute1\"])\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.prog_list-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.prog_list","text":"prog_list(prog, tRs)\n\nGenerate a vector of program conditions, excluding rows with missing values in tRs.\n\nArguments\n\nprog: A program condition or vector of programs.\nIf a single Program: repeated for all measurements and substances.\nIf a Vector{Program}: one program per measurement (length must match number of rows in tRs).\ntRs: A 2D array where each row corresponds to a set of retention times and columns to different substances.\n\nReturns\n\nA vector of program conditions corresponding to non-missing rows in tRs.\n\nExamples\n\njulia> using RetentionParameterEstimator, GasChromatographySimulator\n\njulia> tRs = [100.0 150.0; 200.0 250.0]\n2×2 Matrix{Float64}:\n 100.0  150.0\n 200.0  250.0\n\njulia> prog_single = GasChromatographySimulator.Program([0.0, 5.0], [40.0, 340.0], [150000.0, 250000.0], \"vacuum\", \"min\")\nGasChromatographySimulator.Program(...)\n\njulia> prog_vec = [prog_single, prog_single]\n2-element Vector{GasChromatographySimulator.Program}:\n GasChromatographySimulator.Program(...)\n\njulia> # Single program (repeated)\n       prog_list(prog_single, tRs)\n4-element Vector{GasChromatographySimulator.Program}:\n GasChromatographySimulator.Program(...)\n\njulia> # Vector of programs (one per measurement)\n       prog_list(prog_vec, tRs)\n4-element Vector{GasChromatographySimulator.Program}:\n GasChromatographySimulator.Program(...)\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.reference_holdup_time-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.reference_holdup_time","text":"reference_holdup_time(prog, L, d, gas; control=\"Pressure\")\n\nCalculate the reference holdup time for the GC program prog for a column with length L and diameter d and gas as mobile phase. The reference holdup time is the holdup time at the reference temperature 150°C.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.separate_error_columns-Tuple{Any}","page":"Docstrings","title":"RetentionParameterEstimator.separate_error_columns","text":"separate_error_columns(res)\n\nIf the result dataframe res contains columns with Measurements typed values, these columns will be split in two. The first column contains the value and uses the original column name. The second column contains the uncertainty and the name of the column is the original name with an added \"_uncertainty\". If the column is not of the Measurements type, it will be copied as is for the new dataframe.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.stderror_m3-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.stderror_m3","text":"stderror_m3(meas, res; opt=std_opt, metric=\"squared\", parallel=false)\n\nCalculation of the standard error of the found optimized parameters (including column diameter d) using the hessian matrix at the optima. Used for method_m3 which optimizes all parameters jointly.\n\nAttention\n\nThe used loss-function is hard coded in the function opt_dKcentric and has to be changed if another loss-function is used.\n\nArguments\n\nmeas ... Tuple with the loaded measurement data, see load_chromatograms.\nres ... Dataframe with the result of the optimization, see estimate_parameters.\n\nOptional parameters:\n\nopt=std_opt ... Options for the ODE solver.\nmetric=\"squared\" ... Metric used for the loss function (\"squared\" or \"abs\").\nparallel=false ... If true, use parallelization for standard error calculations (requires Julia to be started with multiple threads, e.g., julia -t 4).\n\nOutput\n\nstderrors ... Dataframe with the standard errors of the optimized parameters (including d).\nHessian ... The hessian matrix at the found optima. \n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.substance_list-Tuple{Any, Any}","page":"Docstrings","title":"RetentionParameterEstimator.substance_list","text":"substance_list(substance_names, tRs)\n\nGenerate a vector of substance names, excluding rows with missing values in tRs.\n\nArguments\n\nsubstance_names: A vector of substance names.\ntRs: A 2D array where each row corresponds to a set of retention times and columns to different substances.\n\nReturns\n\nA vector of substance names corresponding to non-missing rows in tRs.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.tR_calc-NTuple{7, Any}","page":"Docstrings","title":"RetentionParameterEstimator.tR_calc","text":"tR_calc(Tchar, θchar, ΔCp, L, d, prog, gas; opt=std_opt)\n\nCalculates the retention time tR for a solute with the K-centric parameters Tchar θchar and ΔCp for a column with length L, internal diameter d, the (conventional) program prog, options opt and mobile phase gas. For this calculation only the ODE for the migration of a solute in a GC column is solved, using the function GasChromatographySimulator.solving_migration.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.tR_τR_calc-NTuple{11, Any}","page":"Docstrings","title":"RetentionParameterEstimator.tR_τR_calc","text":"tR_τR_calc(Tchar, θchar, ΔCp, L, d, df, prog, Cag, t₀, τ₀, gas; opt=std_opt)\n\nCalculates the retention time tR for a solute with the K-centric parameters Tchar θchar and ΔCp for a column with length L, internal diameter d, film thickness df, the (conventional) program prog, diffusirivity coefficient Cag, start time t₀, initial peak width τ₀, options opt and mobile phase gas. For this calculation the ODE-system for the migration of a solute and peak width in a GC column is solved, using the function GasChromatographySimulator.solving_odesystem_r. The result is a tuple of retention time tR and peak width τR.\n\n\n\n\n\n","category":"method"},{"location":"docstrings/#RetentionParameterEstimator.time_unit_conversion_factor-Tuple{Any}","page":"Docstrings","title":"RetentionParameterEstimator.time_unit_conversion_factor","text":"time_unit_conversion_factor(time_unit)\n\nGet the conversion factor for time units.\n\nArguments\n\ntime_unit: String indicating time unit, either \"min\" or \"s\".\n\nReturns\n\nConversion factor: 60.0 for \"min\", 1.0 for \"s\" (or any other value).\n\nExamples\n\njulia> using RetentionParameterEstimator\n\njulia> RetentionParameterEstimator.time_unit_conversion_factor(\"min\")\n60.0\n\njulia> RetentionParameterEstimator.time_unit_conversion_factor(\"s\")\n1.0\n\n\n\n\n\n","category":"method"}]
}
